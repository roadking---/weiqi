extends ../layout

block title
	title= lingua.title_home_page
	
block append scripts
	script(type='text/javascript', src='/js/BoardCanvas.js')
	script(type='text/javascript', src='/json/home')
	script(type='text/javascript', src='/js/home.js')
	
block content
	#home.container
		#pendings
		#attendings
		#blogs
		a#prev_blogs_btn= lingua.prev_blogs
	
	include ../tpls/blogs_tpl

	script#pendings_tpl(type='text/template').
		<ul>
			<% _.each(data.games.pendings, function(gid){ %>
				<li>
					<% p = refs[gid].players[0] %><%= player_tpl({user:refs[p]}) %>
					<a class='attend' title='#{lingua.start_game}' href='/attend/<%=gid%>'>Attend</a>
				</li>
			<% }); %>
		</ul>
	script#attendings_tpl(type='text/template').
		<ul>
			<% _.each(data.games.attendings, function(gid){ %>
				<% if(data.refs[gid].seats){ %>
					<li>
						<% my_seat = _.invert(data.refs[gid].seats)[data.myself]; opponent = _.without(data.refs[gid].players, data.myself)[0];  %>
						<span class='caption'><%= my_seat == 'black' ? '#{lingua.seat_black}' : '#{lingua.seat_white}' %>#{lingua.with} <%= player_tpl({user:data.refs[opponent]}) %></span>
						<a class='thumb' href='/game/<%=gid%>'></a>
					</li>
				<% } else if(data.refs[gid].players.length == 1){ %>
					<li class='new-game'>
						<a href='/game/<%=gid%>'>
							<span>#{lingua.home_new_game_str1}</span>
							<br>
							<span>#{lingua.home_new_game_str2}</span>
						</a>
					</li>
				<% } else { %>
					<li>
						xxx
					</li>
				<% } %>
			<% }); %>
		</ul>
	