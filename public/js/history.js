// Generated by CoffeeScript 1.6.2
(function() {
  $(function() {
    var data, uid, _ref;

    uid = (_ref = /history\/(.+)$/.exec(location.pathname)) != null ? _ref[1] : void 0;
    if (!uid) {
      return;
    }
    $.get("/json/history/" + uid, function(data) {
      console.log(data);
      init_header(data);
      $('#records').append(tpl('#records-tpl')(data));
      return new Morris.Line({
        element: 'rate-chart',
        data: _.map(data.records, function(x) {
          x.time = moment(x.ts * 1000).format('YYYY-MM-DD HH:mm');
          return x;
        }),
        xkey: 'time',
        ykeys: ['rate'],
        labels: ['Rate'],
        ymax: 'auto',
        ymin: 'auto'
      });
    });
    return;
    data = JSON.parse($('#rate-chart').attr('data'));
    data = _.chain(data).sortBy('ts').map(function(x) {
      x.time = moment(x.ts * 1000).format('YYYY-MM-DD HH:mm');
      return x;
    }).value();
    return new Morris.Line({
      element: 'rate-chart',
      data: data,
      xkey: 'time',
      ykeys: ['rate'],
      labels: ['Rate'],
      ymax: 'auto',
      ymin: 'auto'
    });
  });

}).call(this);
